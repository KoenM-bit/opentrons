test_name: Invalid authentication token handling.
marks:
  - usefixtures:
      - ot2_server_base_url
stages: 
  - name: Invalid auth token with version 2
    request:
      url: '{ot2_server_base_url}/robot/lights'
      method: POST
      json:
        "on": "true"
      headers:
        Opentrons-Version: 2
        authenticationBearer: invalid_token
    response:
      status_code: 200

  - name: Invalid auth token with version 3
    request:
      url: '{ot2_server_base_url}/robot/lights'
      method: POST
      json:
        "on": "true"
      headers:
        Opentrons-Version: 3
        authenticationBearer: invalid_token
    response:
      status_code: 200

  - name: Invalid auth token with version 4
    request:
      url: '{ot2_server_base_url}/robot/lights'
      method: POST
      json:
        "on": "true"
      headers:
        Opentrons-Version: 4
        authenticationBearer: invalid_token
    response:
      status_code: 200

  - name: Invalid auth token with version 5
    request:
      url: '{ot2_server_base_url}/robot/lights'
      method: POST
      json:
        "on": "true"
      headers:
        Opentrons-Version: 5
        authenticationBearer: invalid_token
    response:
      status_code: 403

  - name: Missing auth token with version 5
    request:
      url: '{ot2_server_base_url}/robot/lights'
      method: POST
      json:
        "on": "true"
      headers:
        Opentrons-Version: 5
        authenticationBearer: ''
    response:
      status_code: 403

  - name: Valid auth token with version 5
    request:
      url: '{ot2_server_base_url}/robot/lights'
      method: POST
      json:
        "on": "true"
      headers:
        Opentrons-Version: 5
    response:
      status_code: 200

  - name: Missing auth token on a GET endpoint with version 5
    request:
      url: '{ot2_server_base_url}/robot/lights'
      method: GET
      headers:
        Opentrons-Version: 5
        authenticationBearer: ''
    response:
      status_code: 200

  - name: Valid auth token on a GET endpoint with version 5
    request:
      url: '{ot2_server_base_url}/robot/lights'
      method: GET
      headers:
        Opentrons-Version: 5
    response:
      status_code: 200
    
    